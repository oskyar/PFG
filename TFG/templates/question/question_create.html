{% extends 'base.html' %}
{% load static from staticfiles %}
{% load i18n %}
{% block title %}Ponte a prueba - Creando Preguntas{% endblock title %}
<!-- Wide card with share menu button -->
{% block content %}

    <div class="row">
        <div class=" col l8 m8 s12 subject-card">
            <h3 class="deep-orange-text header center-align tooltipped"
                data-tooltip="{% trans 'Asignatura' %}">{{ current_subtopic.topic.subject.name }}</h3>
            <h4 class="orange-text header center-align tooltipped"
                data-tooltip="{% trans 'Tema' %}"> {{ current_subtopic.topic.cardinality }}
                - {{ current_subtopic.topic.name }}</h4>

            <h5 class="teal-text header center-align tooltipped"
                data-tooltip="{% trans 'Subtema' %}">{{ current_subtopic.name }}</h5>

            <div class="row">

                <div class="col l12 m12 s12 ">
                    <form method="POST" enctype="multipart/form-data" action="">
                        {% csrf_token %}
                        <div class="row">
                            <div class="input-field col l3 m3 s12">

                                {{ form.type }}

                                {% comment %}
                                <select id="{{ form.type.id_for_label }}" class="select_choice browser-default"
                                        name="{{ form.type.id_for_label }}">
                                    {% for choice in form.type.field.choices %}
                                        <option value={{ choice.0 }}>{{ choice.1 }}</option>
                                    {% endfor %}
                                </select>
                                <label for="{{ form.type.id_for_label }}">{{ form.type.label }}</label>
                                {% endcomment %}
                            </div>

                            <div class="input-field col l9 m9 s12">
                                {{ form.statement }}
                                <label for="{{ form.statement.id_for_label }}"
                                       data-error="{{ form.statement.errors|striptags }}"
                                       data-success="Enunciado correcto">{{ form.statement.label }}</label>
                            </div>
                        </div>

                        <div class="row">

                            {{ inlines.management_form }}
                            {% for questions in inlines %}
                                {{ questions.management_form }}
                                {% comment %}
                                {{ questions.as_p }}
                                {% endcomment %}

                                {% for question in questions %}
                                    {{ question.id }}
                                    <div class="replies-container">
                                        <div class="input-field col l1 m1 s2">
                                            {{ question.valid }}
                                            <label for="{{ question.valid.id_for_label }}"></label>
                                        </div>
                                        <div class="input-field col l9 m9 s7">
                                            {{ question.reply }}
                                            <label for="{{ question.reply.id_for_label }}"
                                                   data-error="{{ question.reply.errors|striptags }}"
                                                   data-success="Respuesta formulada correctamente">{{ question.reply.label }}</label>
                                        </div>
                                        <div class="input-field col l2 m2 s3">
                                            {{ question.adjustment }}
                                            <label for="{{ question.adjustment.id_for_label }}"
                                                   data-error="{{ question.adjustment.errors|striptags }}"
                                                   data-success=""></label>
                                        </div>
                                    </div>
                                {% endfor %}
                            {% endfor %}


                        </div>

                        {% comment %}
                        {% for element in form %}

                                <div class="input-field col s12 m12 l12">
                                    {{ element.label_tag }}
                                    {{ element }}
                                    {{ element.errors }}
                                </div>
                            {% endfor %}
                            {% endcomment %}

                        <button type="submit" id="submit_question" class="btn waves-effect waves-light">Crear otra
                            pregunta
                        </button>
                    </form>
                </div>
            </div>
            <div class="row">
                <div class="list-answers col l12 m12 s12 ">
                    <h4 class="teal-text header">Preguntas</h4>
                    <div class="divider"></div>
                    <ul class="collapsible" data-collapsible="accordion">
                        {% for question in questions %}
                            <li id="question_{{ question.id }}">
                                <div class="collapsible-header">
                                    <i class="material-icons">filter_drama</i>
                                    {{ question.statement }}
                                    <div id="{{ question.id }}"
                                         data-url="{% url 'delete_question' pk=question.subtopic.topic.subject.id pk_topic=question.subtopic.topic.id pk_subtopic=question.subtopic.id pk_question=question.id %}"
                                         class="icon-edit delete_question waves-block waves-effect waves-button-input right waves-circle ">
                                        <i class="material-icons red-text">delete</i>
                                    </div>
                                    <div class="icon-edit edit_button waves-block waves-effect waves-button-input right waves-circle ">
                                        <i class="material-icons blue-grey-text">edit</i>
                                        {% comment %}<a href="{% url 'delete_question' question.topic.subject.id question.topic.id question.id %}"></a>
                                                {% endcomment %}
                                    </div>
                                </div>
                                <div class="collapsible-body">
                                    <ol>
                                        {% for answer in question.answers %}
                                            {% if answer.valid %}
                                                <li class="valid"
                                                    title="{% trans 'Respuesta correcta' %}">{{ answer.reply }}</li>
                                            {% else %}
                                                <li>{{ answer.reply }}</li>
                                            {% endif %}
                                        {% endfor %}
                                    </ol>
                                </div>
                            </li>
                        {% endfor %}

                    </ul>


                </div>
            </div>

        </div>

        <div class="list-topics col l4 m4 s12 ">
            <h4 class="teal-text center-align">Subtemas</h4>
            <ol>
                {% for subtopic in subtopics %}
                    <li>
                        <a type="submit"
                           href="{% url 'create_question' subtopic.topic.subject.id subtopic.topic.id subtopic.id %}"
                           class="btn waves-effect waves-light">{{ subtopic.name }}
                            largo</a>
                    </li>
                {% endfor %}
            </ol>
        </div>
    </div>
{% endblock content %}

{% block script_code %}
    initialize_question_view();
{% endblock %}